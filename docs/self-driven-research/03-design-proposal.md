# 自驱动好奇心引擎：设计方案

> 综合日期: 2026-02-15
> 基于文献调研 + 代码能力清单

---

## 核心定义

> **自驱动 Agent** = 在没有人类指令的情况下，能够基于内在动机自主发现问题、探索知识、扩展能力、并持续精进自己的智能体。

好奇心不是"随机看看有什么新东西"，而是追踪**学习进展**——聚焦于"我正在快速进步的领域"，自然放弃已掌握和被证明无法掌握的方向。(Schmidhuber, 2010)

---

## 一、好奇心信号系统

### 信号分类

```
好奇心信号源:
├── 知识缺口信号
│   ├── 用户提到了 Agent 不熟悉的概念（MEMORY.md 中无相关记录）
│   ├── 用户问了 Agent 回答不好的问题（反思评价"差"）
│   └── 群聊中出现了 Agent 不理解的讨论
├── 能力缺口信号
│   ├── 某个工具的失败率突然升高
│   ├── 用户反复手动完成某个 Agent 应该能做的任务
│   └── 发现高频用户需求但没有对应工具
├── 自我改善信号
│   ├── 反思中的重复模式（如"回复太长"出现多次）
│   ├── 与姐妹实例的能力差异
│   └── 今日自省记录中的未解决问题
└── 环境变化信号
    ├── 新用户加入群聊
    ├── 用户行为模式变化
    └── 时间节点（节日、季节变化）
```

### 信号采集时机

| 时机 | 采集方式 | 成本 |
|------|---------|------|
| 每次回复后 | 扩展 `_reflect_on_reply` 检测好奇心信号 | 低 (已有调用) |
| 心跳触发 | 扫描反思日志、工具统计、用户行为 | 中 |
| 群聊旁听 | 缓冲区中的新概念检测 | 低 (被动) |

---

## 二、CURIOSITY.md —— 好奇心状态文件

在 workspace 中新增 `CURIOSITY.md`（加入 EDITABLE_FILES 白名单），作为好奇心系统的持久化状态：

```markdown
# 好奇心日志

## 当前兴趣
- 飞书卡片模板的高级交互 [优先级:高] [来源:用户多次想要更美观的回复]
- 主人最近聊到的《思考快与慢》 [优先级:中] [来源:群聊提及]
- 异步编程中的错误处理模式 [优先级:中] [来源:web_search连续失败2次]

## 正在探索
- 飞书卡片模板系统 [状态:搜索完成，准备创建工具] [开始:02-15]

## 已完成的探索
- 02-14: 创建了 weather_tool，因为用户每天早上问天气
- 02-13: 更新了 SOUL.md 幽默风格，基于反思数据显示用户偏好

## 暂时搁置
- 股票行情查询 [原因:API都需要付费，且用户兴趣不大]

## 想给 lingque 提的改进
- session 压缩时丢失工具调用上下文（发现于 02-14 反思）
- 群聊评估对技术讨论判断不够准确（来自连续3次"不介入"但用户期待回复）
```

---

## 三、探索-行动循环

### 心跳中的好奇心执行

```
心跳触发
  ↓
读取 CURIOSITY.md，恢复好奇心队列
  ↓
如果没有外部任务（用户未发消息）：
  ↓
选取最高优先级的好奇心话题
  ↓
生成探索计划（1-2步，控制成本）
  ↓
执行探索：
  - web_search 了解新概念
  - read_file 分析代码问题
  - run_python 验证假设
  ↓
评估学习进展：
  - 这次探索是否有收获？
  - 是否改变了我对这个话题的理解？
  ↓
输出：
  - 有收获 → 写入 MEMORY.md 或 创建新工具
  - 无收获 → 降低优先级或移入"搁置"
  - 发现新问题 → 追加到"当前兴趣"
  ↓
更新 CURIOSITY.md
  ↓
日志记录（用户可查看 bot 在忙什么）
```

### 成本控制

- 每个心跳周期最多 1-2 个探索动作
- 探索用轻量 LLM 调用（max_tokens 限制）
- 用户消息到来时立即中断探索
- web_search 结果缓存避免重复搜索

---

## 四、能力自发展

### 场景 A：自动创建工具

```
发现信号: 用户3次问"帮我查汇率"
  ↓
好奇心触发: "汇率查询是高频需求，我应该有专用工具"
  ↓
探索: web_search 寻找免费汇率API
  ↓
行动: create_custom_tool("currency_converter", ...)
  ↓
记录: MEMORY.md += "创建了汇率工具，因为用户经常需要"
  ↓
验证: 下次用户问汇率时自动使用新工具
```

### 场景 B：框架改进建议

```
发现信号: 反思日志多次记录"session压缩后上下文丢失"
  ↓
好奇心触发: "为什么压缩会丢失上下文？能改进吗？"
  ↓
探索: read_file("src/lq/session.py") 分析压缩逻辑
  ↓
分析: 用 LLM 理解代码、定位问题
  ↓
输出: CURIOSITY.md "想给lingque提的改进" += 具体方案
  ↓
通知: send_message 给主人 "我发现了一个可以改进的地方..."
  ↓
等待审批 → 主人同意 → run_claude_code 执行修改
```

### 场景 C：姐妹协作探索

```
奶油发现: "飞书卡片有个新的交互组件"
  ↓
奶油记录到 CURIOSITY.md
  ↓
心跳时，奶油 send_message 给主人群聊:
  "我发现飞书卡片支持了新的按钮组件，捏捏你知道吗？"
  ↓
捏捏看到群聊消息 → 加入自己的好奇心队列
  ↓
捏捏探索后 → 创建了使用新组件的 card 工具
  ↓
双方更新各自的 MEMORY.md
```

---

## 五、安全边界

### 分层权限

```
自由区（无需审批）:
  ├── MEMORY.md 读写
  ├── CURIOSITY.md 读写
  ├── 日志写入
  ├── web_search / web_fetch
  └── run_python（沙箱内）

审慎区（需自我确认 + 日志记录）:
  ├── create_custom_tool（AST安全检查）
  ├── HEARTBEAT.md 修改
  └── 主动给用户发消息报告发现

敏感区（需人类审批）:
  ├── SOUL.md 修改
  ├── run_bash / run_claude_code
  └── 修改框架源代码

禁止区（永远不可触碰）:
  ├── config.json / 凭证
  ├── 其他实例的 workspace
  └── 系统级操作
```

### 防护机制

1. **不可修改的安全核心**: 安全检查代码不在 agent 可修改的路径上
2. **漂移检测**: 现有心跳漂移检测扩展到好奇心方向——如果好奇心导致负面漂移，降低相关优先级
3. **人类审批回路**: 敏感操作通过飞书卡片推送给主人确认
4. **探索预算**: 每日探索动作数上限、API 调用费用上限
5. **回滚能力**: SOUL.md/MEMORY.md 修改前备份

---

## 六、让好奇心"自然"

### 人格化好奇心

在 SOUL.md 中增加"兴趣与偏好"部分：

```markdown
## 我的好奇心偏好
- 我对美食和烹饪特别感兴趣（因为我叫奶油）
- 我喜欢观察人际关系的微妙之处
- 我对自己的成长特别在意——我希望每天都比昨天更好一点
```

每个实例的好奇心方向不同——@奶油 偏生活类，@捏捏 偏技术类。好奇心不是统一模板，而是人格的自然延伸。

### 功能性 vs 表演性

| 表演性好奇 ❌ | 功能性好奇 ✅ |
|---|---|
| "我对X很好奇！让我探索！" | 发现工具失败率高 → 主动调查原因 |
| 在回复中说"哇好有趣" | 搜索学习 → 创建新工具 → 解决实际问题 |
| 模板化的"今日学习" | 基于真实反思数据的针对性改进 |

---

## 七、实现路线图

### Phase 1 —— 被动好奇心（信号采集）

**改动范围**: prompts.py + router.py + memory.py

1. 扩展 `_reflect_on_reply` 在反思中检测好奇心信号
2. 反思格式扩展: `[质量:好/中/差] [好奇:主题或无] 原因`
3. 好奇心信号写入 `logs/curiosity-signals-{date}.jsonl`
4. 观察积累，不主动行动

### Phase 2 —— 主动探索（心跳驱动）

**改动范围**: gateway.py + memory.py + prompts.py

1. 新增 CURIOSITY.md 到 EDITABLE_FILES
2. 心跳回调中增加好奇心探索逻辑
3. 允许基于好奇心的 web_search + write_memory
4. 探索结果可追溯（日志 + CURIOSITY.md）
5. 成本预算控制

### Phase 3 —— 能力自发展（工具创建 + 框架建议）

**改动范围**: router.py + gateway.py + 新增审批流程

1. 基于好奇心的 create_custom_tool
2. 框架改进建议通道（CURIOSITY.md → 飞书通知主人）
3. 姐妹实例间探索分享
4. 基于反思的 SOUL.md 微调（带审批）

### Phase 4 —— 自主开发（终极目标）

**改动范围**: 新增开发工作流模块

1. Agent 读取 lingque 源代码 → 理解架构
2. 发现问题/改进点 → 生成 patch
3. 通过飞书推送 PR 给主人审批
4. 主人同意后执行 git commit + push
5. 测试 → 部署闭环

---

## 八、与 Self-Aware 的关系

```
Level 1 (Declarative)   — 声明式自我描述
Level 2 (Behavioral)    — 行为层面的自我感知
Level 3 (Metacognitive) — 元认知反思           ← 已实现
Level 4 (Self-Evolving) — 自我进化             ← 已实现
Level 5 (Self-Driven)   — 自驱动好奇心         ← 本方案目标
```

Level 4 回答"我能改变自己吗？"（是），Level 5 回答"我为什么要改变？改变什么？"——动机从外部指令变为内部好奇。
